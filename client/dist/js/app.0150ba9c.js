(function(e){function t(t){for(var r,s,i=t[0],a=t[1],c=t[2],d=0,p=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);u&&u(t);while(p.length)p.shift()();return l.push.apply(l,c||[]),n()}function n(){for(var e,t=0;t<l.length;t++){for(var n=l[t],r=!0,i=1;i<n.length;i++){var a=n[i];0!==o[a]&&(r=!1)}r&&(l.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},l=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=a;l.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"344a":function(e,t,n){"use strict";n("b981")},3503:function(e,t,n){"use strict";n("80b5")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function o(e,t,n,o,l,s){var i=Object(r["w"])("requests");return Object(r["o"])(),Object(r["f"])(i)}n("a4d3"),n("e01a"),n("9911");var l=n("610a"),s=n.n(l),i=Object(r["G"])("data-v-49ea2798");Object(r["r"])("data-v-49ea2798");var a={class:"container mb-14 p-8"},c=Object(r["i"])("img",{alt:"bees",src:s.a,style:{opacity:"60%",width:"35%",display:"block","margin-left":"auto","margin-right":"auto"}},null,-1),u=Object(r["i"])("p",{class:"mt-8 font-medium font-sans text-2xl"},"Poll'em",-1),d=Object(r["i"])("p",{class:"font-sans mb-8"},[Object(r["h"])(" A simple & hassle-free poll application "),Object(r["i"])("span",{class:"font-thin"}," with a Haskell backend.")],-1),p={key:0,class:"m-4"},b={key:1,class:"m-4"},f=Object(r["i"])("p",null," You do not appear to be authenticated on this app. This means you can only view already existing polls. How about you authenticate so that you can start creating polls? ",-1),h={class:"m-8"},g={key:1,class:"disabled:opacity-50 ml-2 p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md",disabled:""},m={key:0,class:"mt-4"},y={key:1,class:"disabled:opacity-50 p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75",disabled:""},O={key:1,class:"mt-10"},j={id:"displayed",class:"flex flex-col"},k=Object(r["i"])("label",{for:"takingMultiple"},"Allowed to select multiple answers?",-1),v=Object(r["i"])("label",{for:"takingVisible"},"Results visible during poll?",-1),_={class:"space-x-3"},w=Object(r["i"])("label",{for:"takingStartDate"},"Poll started at:",-1),P={key:0},x=Object(r["i"])("label",{class:"space-y-3",for:"takingEndDate"},"(optional) Poll due to close at:",-1),D={key:2},S=Object(r["i"])("p",null,"Nothing to render.",-1),q={id:"creatingPoll",class:"flex flex-col"},A={class:"mt-5"},C=Object(r["i"])("label",{for:"creatingMultiple"},"Allow to select multiple answers",-1),$=Object(r["i"])("label",{for:"creatingVisible"},"Make results visible during poll",-1),T={class:"mt-3 space-y-2"},V=Object(r["i"])("label",{for:"creatingStartDate"},"Poll should start at:",-1),R=Object(r["i"])("br",null,null,-1),I=Object(r["i"])("label",{for:"creatingEndDate"},"(optional) Poll should end at:",-1),E={key:0},M={key:0,class:"font-bold"},N={key:1,class:"font-bold"},J={class:"mt-5"},U=Object(r["i"])("p",{class:"text-sm font-light"}," You've taken or created polls you think should be displayed here? You can retrieve your entire history. Please be considerate in your use of this feature, as the database is not optimized for this (expect serious debounce). Also your last created poll might be missing if you created it very recently. ",-1);Object(r["p"])();var H=i((function(e,t,n,o,l,s){var H=Object(r["w"])("tab"),Y=Object(r["w"])("vue-echarts"),z=Object(r["w"])("datepicker"),L=Object(r["w"])("tabs");return Object(r["o"])(),Object(r["f"])("div",a,[c,u,d,Object(r["i"])("div",null,[Object(r["i"])(L,{modelValue:o.active,"onUpdate:modelValue":t[19]||(t[19]=function(e){return o.active=e})},{default:i((function(){return[Object(r["i"])(H,{title:"Your account"},{default:i((function(){return[s.loggedIn?(Object(r["o"])(),Object(r["f"])("div",p,[Object(r["i"])("p",null,"Welcome, "+Object(r["y"])(l.user.email),1),Object(r["i"])("button",{onClick:t[1]||(t[1]=function(){return s.logout&&s.logout.apply(s,arguments)}),class:"mt-2 p-1 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Logout ")])):(Object(r["o"])(),Object(r["f"])("div",b,[f,Object(r["i"])("div",h,[Object(r["i"])("div",null,[Object(r["E"])(Object(r["i"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.user.email=e}),type:"text",placeholder:"email address",disabled:l.user.token_asked},null,8,["disabled"]),[[r["A"],l.user.email]]),l.user.token_asked?(Object(r["o"])(),Object(r["f"])("button",g," Authenticate ")):(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[3]||(t[3]=function(){return s.askToken&&s.askToken.apply(s,arguments)}),class:"ml-2 p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Authenticate "))]),l.user.token_asked?(Object(r["o"])(),Object(r["f"])("div",m,[Object(r["E"])(Object(r["i"])("input",{"onUpdate:modelValue":t[4]||(t[4]=function(e){return l.user.token=e}),type:"text",placeholder:"paste the token here"},null,512),[[r["A"],l.user.token]]),l.user.token.length>3&&!l.user.token_sent?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[5]||(t[5]=function(){return s.confirmToken&&s.confirmToken.apply(s,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Confirm token ")):Object(r["g"])("",!0),l.user.token_sent?(Object(r["o"])(),Object(r["f"])("button",y," Confirm token ")):Object(r["g"])("",!0)])):Object(r["g"])("",!0)])]))]})),_:1}),Object(r["i"])(H,{title:"Take the poll"},{default:i((function(){return["dev"!==e.AppMode||l.displayed.poll_startDate?Object(r["g"])("",!0):(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[6]||(t[6]=function(){return e.testChart&&e.testChart.apply(e,arguments)})}," Test chart ")),l.displayed.poll_startDate?(Object(r["o"])(),Object(r["f"])("div",O,[Object(r["i"])("div",j,[Object(r["i"])("div",null,[Object(r["i"])("textarea",{id:"takingQuestion",rows:"2",cols:"30",value:l.displayed.poll_question,disabled:""},null,8,["value"])]),l.chart.scores.length>0&&l.displayed.poll_visible?(Object(r["o"])(),Object(r["f"])(Y,{key:0,option:l.chart.options,style:s.chartStyle,ref:"chart"},null,8,["option","style"])):Object(r["g"])("",!0),Object(r["i"])("div",null,[Object(r["i"])("textarea",{id:"takingDescription",rows:"3",cols:"45",value:l.displayed.poll_description,disabled:""},null,8,["value"])]),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(l.displayed.poll_results,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{key:t},[Object(r["i"])("div",null,[Object(r["i"])("label",null,Object(r["y"])(e.text),1),Object(r["i"])("input",{class:"ml-4",type:"checkbox",onChange:function(e){return s.toggleResults(t)},checked:e.value},null,40,["onChange","checked"])])])})),128)),Object(r["i"])("div",null,[k,Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"takingMultiple",checked:l.displayed.poll_multiple,disabled:""},null,8,["checked"]),v,Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"takingVisible",checked:l.displayed.poll_visible,disabled:""},null,8,["checked"])]),Object(r["i"])("div",_,[w,Object(r["i"])("input",{type:"text",id:"takingStartDate",value:l.displayed.poll_startDate,disabled:""},null,8,["value"]),l.displayed.poll_endDate?(Object(r["o"])(),Object(r["f"])("div",P,[x,Object(r["i"])("input",{type:"text",id:"takingEndDate",value:l.displayed.poll_endDate,disabled:""},null,8,["value"])])):Object(r["g"])("",!0)])]),"prod"===e.AppMode?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[7]||(t[7]=function(){return s.takePoll&&s.takePoll.apply(s,arguments)}),class:"my-5 w-1/3 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Take the poll ")):(Object(r["o"])(),Object(r["f"])("button",{key:1,onClick:t[8]||(t[8]=function(){return e.testSubmitPoll&&e.testSubmitPoll.apply(e,arguments)}),class:"my-5 w-1/3 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Take the poll "))])):(Object(r["o"])(),Object(r["f"])("div",D,[S]))]})),_:1}),Object(r["i"])(H,{title:"Create a poll"},{default:i((function(){return[Object(r["i"])("div",q,[Object(r["i"])("div",null,[Object(r["E"])(Object(r["i"])("textarea",{id:"creatingQuestion",rows:"2",cols:"30","onUpdate:modelValue":t[9]||(t[9]=function(e){return l.creatingPoll.question=e})},null,512),[[r["A"],l.creatingPoll.question]])]),Object(r["i"])("div",null,[Object(r["E"])(Object(r["i"])("textarea",{id:"creatingDescription",rows:"3",cols:"45","onUpdate:modelValue":t[10]||(t[10]=function(e){return l.creatingPoll.description=e})},null,512),[[r["A"],l.creatingPoll.description]])]),Object(r["i"])("div",null,[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(l.creatingPoll.answers,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{class:"my-4",key:"answer"+t},[Object(r["i"])("label",{class:"mr-4",for:"creatingAnswer"+t},"Answer #"+Object(r["y"])(t+1),9,["for"]),Object(r["i"])("input",{type:"text",onInput:function(e){return l.creatingPoll.answers[t]=e.target.value}},null,40,["onInput"])])})),128))]),Object(r["i"])("div",null,[Object(r["i"])("button",{onClick:t[11]||(t[11]=function(){return s.addAnswer&&s.addAnswer.apply(s,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," more answers... "),l.creatingPoll.answers.length>2?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[12]||(t[12]=function(){return s.removeAnswer&&s.removeAnswer.apply(s,arguments)}),class:"ml-2 p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," less ")):Object(r["g"])("",!0)]),Object(r["i"])("div",A,[C,Object(r["E"])(Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"creatingMultiple","onUpdate:modelValue":t[13]||(t[13]=function(e){return l.creatingPoll.multiple=e})},null,512),[[r["z"],l.creatingPoll.multiple]]),$,Object(r["E"])(Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"creatingVisible","onUpdate:modelValue":t[14]||(t[14]=function(e){return l.creatingPoll.visible=e})},null,512),[[r["z"],l.creatingPoll.visible]])]),Object(r["i"])("div",T,[V,Object(r["i"])(z,{id:"creatingStartDate",modelValue:l.creatingPoll.startDate,"onUpdate:modelValue":t[15]||(t[15]=function(e){return l.creatingPoll.startDate=e})},null,8,["modelValue"]),R,I,Object(r["i"])(z,{id:"creatingEndDate",modelValue:l.creatingPoll.endDate,"onUpdate:modelValue":t[16]||(t[16]=function(e){return l.creatingPoll.endDate=e})},null,8,["modelValue"])])]),Object(r["i"])("button",{onClick:t[17]||(t[17]=function(){return s.createPoll&&s.createPoll.apply(s,arguments)}),class:"my-5 w-1/3 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Create the poll ")]})),_:1}),s.loggedIn?(Object(r["o"])(),Object(r["f"])(H,{key:0,title:"My Polls"},{default:i((function(){return[s.mypolls?(Object(r["o"])(),Object(r["f"])("div",E,[l.user.created.length>0?(Object(r["o"])(),Object(r["f"])("p",M," Created ")):Object(r["g"])("",!0),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(l.user.created,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{key:t,class:"grid grid-cols-3 gap-1"},[Object(r["i"])("a",{href:e.link},Object(r["y"])(e.question),9,["href"]),Object(r["i"])("input",{value:e.startDate,disabled:""},null,8,["value"]),Object(r["i"])("input",{value:e.endDate||"No end date.",disabled:""},null,8,["value"])])})),128)),l.user.taken.length>0?(Object(r["o"])(),Object(r["f"])("p",N," Taken ")):Object(r["g"])("",!0),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(l.user.taken,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{key:t,class:"grid grid-cols-3 gap-1"},[Object(r["i"])("input",{value:e.question,disabled:""},null,8,["value"]),Object(r["i"])("input",{value:e.startDate,disabled:""},null,8,["value"]),e.endDate?(Object(r["o"])(),Object(r["f"])("input",{key:0,value:e.endDate,disabled:""},null,8,["value"])):Object(r["g"])("",!0),Object(r["i"])("a",{href:e.link},"Go to poll",8,["href"])])})),128))])):Object(r["g"])("",!0),Object(r["i"])("div",J,[U,Object(r["i"])("button",{onClick:t[18]||(t[18]=function(){return s.restoreHistory&&s.restoreHistory.apply(s,arguments)}),class:"mt-4 p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Retrieve entire history ")])]})),_:1})):Object(r["g"])("",!0)]})),_:1},8,["modelValue"])])])})),Y=n("3835"),z=(n("1276"),n("ac1f"),n("caad"),n("2532"),n("4de4"),n("b64b"),n("d3b7"),n("d81d"),n("25f0"),n("159b"),n("7db0"),n("4fad"),n("24e7")),L=n("6f08"),G=n("a5bb"),Q={class:"mx-80 object-center"},B={class:"flex flex-row"},W=Object(r["i"])("div",{class:"bg-gray-300 -m-1 h-1"},null,-1),F={class:"mt-6"};function K(e,t,n,o,l,s){return Object(r["o"])(),Object(r["f"])("div",Q,[Object(r["i"])("ul",B,[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(o.tabs,(function(e,t){return Object(r["o"])(),Object(r["f"])("li",{key:t,class:[o.active===t?"border-b-4 border-yellow-500 text-gray-800":"border-b-2 border-white text-gray-500","flex items-center px-6 py-3 rounded-tl-md rounded-tr-md overflow-hidden cursor-pointer hover:text-gray-800"],onClick:function(e){return o.selectTab(t)}},Object(r["y"])(e.props.title),11,["onClick"])})),128))]),W,Object(r["i"])("div",F,[Object(r["v"])(e.$slots,"default")])])}n("a9e3");var X={name:"Tabs",props:{modelValue:{type:[String,Number]}},emits:["update:modelValue"],setup:function(e,t){var n=t.emit,o=Object(r["d"])((function(){return e.modelValue})),l=Object(r["s"])([]);function s(e){n("update:modelValue",e)}return Object(r["q"])("tabsState",{active:o,tabs:l}),{tabs:l,active:o,selectTab:s}}};X.render=K;var Z=X,ee={key:0};function te(e,t,n,o,l,s){return o.isActive?(Object(r["o"])(),Object(r["f"])("div",ee,[Object(r["v"])(e.$slots,"default")])):Object(r["g"])("",!0)}n("c740");var ne={name:"Tab",props:{title:String},setup:function(){var e=Object(r["k"])(),t=Object(r["m"])("tabsState"),n=t.tabs,o=t.active,l=Object(r["d"])((function(){return n.value.findIndex((function(t){return t.uid===e.uid}))})),s=Object(r["d"])((function(){return l.value===o.value}));return Object(r["C"])((function(){-1===l.value&&n.value.push(e)})),{isActive:s}}};ne.render=te;var re=ne,oe="prod",le=null,se=null,ie={noLocalStorage:"`localStorage API` not supported, this application will not work properly.",noCookieSet:"Sorry but you appear to have cleared your cookies",loaded:"App loaded successfully.",endpoint:"The endpoint ran into an error: "},ae={status:!0,check:function(){return localStorage||(this.status=!1),this.status},set:function(e){localStorage.setItem("pollem-user",JSON.stringify(e))},get:function(){return JSON.parse(localStorage.getItem("pollem-user"))},clear:function(){localStorage.removeItem("pollem-user")}},ce={server_url:{dev:"http://localhost:8009",prod:"https://pollem-now.herokuapp.com"},checkURI:function(e){var t=e.split("/"),n=t[3],r=t[4];if("polls"!==n)return{secret:null,pollid:null};if(r.includes("secret")){var o=r.split("?"),l=o[1],s=l.split("=")[1],i=o[0];return{pollid:i,secret:s}}return{pollid:r,secret:null}},valid_keys:{post:{ask_token:{req:["ask_email"],resp:["resp_ask_token"]},close:{req:["close_hash","close_token","close_pollid"],resp:["resp_close_msg"]},confirm_token:{req:["confirm_token","confirm_fingerprint","confirm_email"],resp:["resp_confirm_msg","resp_confirm_token","resp_confirm_hash"]},create:{req:["create_hash","create_token","create_recipe","create_startDate","create_recipe"],resp:["resp_create_msg","resp_create_pollid","resp_create_pollsecret"]},myhistory:{req:["myhistory_hash","myhistory_token"],resp:[]},take:{req:["take_fingerprint","take_hash","take_token","take_results"],resp:["resp_take_msg"]}},get:{polls:{resp:["resp_get_poll_msg","resp_get_poll","resp_get_poll_scores"]},warmup:{resp:["resp_warmup_msg"]}}},tryPayload:function(e,t){var n=t.filter((function(t){return!Object.keys(e).includes(t)}));if(n.length>0)throw new Error("Missing key(s) from payload: "+JSON.stringify(n))},tryRoute:function(e,t){if(!Object.keys(this.valid_keys[e]).includes(t))throw new Error("Invalid route: "+e+" and route "+t)},makeReq:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.tryRoute(e,t);var o=this.server_url[oe],l=o+"/"+t;if("polls"===t&&(l=l+"/"+le+"?secret="+se),"get"===e)return fetch(l,s).then((function(e){return e.json()})).then((function(r){return n.tryPayload(r,n.valid_keys[e][t].resp),r}));if(null===r)throw new Error("Empty payload found in "+l+"request.");this.tryPayload(r,this.valid_keys[e][t].req);var s={headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(r)};return fetch(l,s).then((function(e){return e.json()})).then((function(r){return n.tryPayload(r,n.valid_keys[e][t].resp),r}))}},ue={name:"requests",components:{Tabs:Z,Tab:re,VueEcharts:L["a"],Datepicker:z["a"]},data:function(){return{creatingPoll:{startDate:null,endDate:null,question:"question...",description:"description...",multiple:!1,visible:!1,private:!1,answers:["Answer#1","Answer#2"]},displayed:{},chart:{scores:[],options:{}},user:{token:"",hash:"",email:"",fingerprint:"",created:[],taken:[],token_asked:!1,token_sent:!1}}},setup:function(){var e,t=ce.checkURI(window.location.href),n=t.pollid,o=t.secret;return null!==n?(le=parseInt(n),se=o,e=Object(r["s"])(1)):e=Object(r["s"])(0),{active:e}},mounted:function(){var e=this;G["a"].load().then((function(e){return e.get()})).then((function(t){if(ae.check()?(e.user=null===ae.get()?e.user:ae.get(),e.user.fingerprint=t.visitorId):e.$toast.error(ie.noLocalStorage),e.creatingPoll.startDate=new Date,null!==le)return ce.makeReq("get","polls").catch((function(t){return e.$toast.error(t)})).then((function(t){var n=t.resp_get_poll;e.displayed=Object.assign(e.displayed,n),n.poll_endDate||(e.displayed.poll_endDate=null),e.displayed.answers&&(e.displayed.answers=n.poll_answers.map((function(e){return{text:e,value:!1}}))),t.resp_get_poll_scores&&(e.chart.scores=t.resp_get_poll_scores.map((function(e){return parseInt(e)})),e.setChartOptions()),e.$toast.success(ie.loaded+" Here is your poll. ("+t.resp_get_poll_msg+")")}));ce.makeReq("get","warmup").catch((function(t){return e.$toast.error(t)})).then((function(t){return e.$toast.info(t.resp_warmup_msg)}))}))},computed:{loggedIn:function(){return[this.user.token,this.user.hash,this.user.email,this.user.fingerprint].every((function(e){return""!==e}))},chartStyle:function(){var e=this.displayed.answers.length;return 0===e?null:"width: 900px; height: "+(75*e).toString()+"px"},mypolls:function(){return this.user.created.length>0||this.user.taken.length>0}},methods:{toggleResults:function(e){this.displayed.poll_results[e].value=!this.displayed.poll_results[e].value,this.displayed.poll_multiple||this.displayed.poll_results.forEach((function(t,n){return t.value=n===e&&t.value}))},addAnswer:function(){var e=this.creatingPoll.answers.length+1;this.creatingPoll.answers.push("Answer#"+e.toString())},removeAnswer:function(){this.creatingPoll.answers.pop()},makeReq:function(e,t,n){var r=this,o=ce.endpoints[this.AppMode],l=ce.tryRoute(e,t);if(null!==l){var s=o+l;if(ce.routes.get.some((function(e){return e===l})))return fetch(s).catch((function(e){return r.$toast.error(e)})).then((function(e){return e.json()}));var i=ce.post[t].filter((function(e){return!Object.keys(n).includes(e)}));if(!(i.length>0)){var a={headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(n)};return fetch(s,a).catch((function(e){return r.$toast.error(e)})).then((function(e){return e.json()}))}this.$toast.error("Missing key(s) from payload: "+JSON.stringify(i))}else this.$toast.error("Bad endpoint! Request aborted.")},askToken:function(){var e=this;this.user.token_asked=!0;var t={ask_email:this.user.email};return ce.makeReq("post","ask_token",t).catch((function(t){return e.$toast.error(t)})).then((function(t){e.$toast.success(t.resp_ask_token,{duration:1e4})}))},confirmToken:function(){var e=this;this.user.token_sent=!0;var t={confirm_token:this.user.token,confirm_fingerprint:this.user.fingerprint,confirm_email:this.user.email};return ce.makeReq("post","confirm_token",t).catch((function(t){return e.$toast.error(t)})).then((function(t){t.resp_confirm_token&&t.resp_confirm_hash?(e.user.token=t.resp_confirm_token,e.user.hash=t.resp_confirm_hash,e.$toast.success(t.resp_confirm_msg)):e.$toast.warning(t.resp_confirm_msg)}))},createPoll:function(){var e=this,t={poll_startDate:this.creatingPoll.startDate,poll_question:this.creatingPoll.question,poll_description:this.creatingPoll.description,poll_multiple:this.creatingPoll.multiple,poll_visible:this.creatingPoll.visible,poll_answers:this.creatingPoll.answers},n={create_hash:this.user.hash,create_token:this.user.token,create_startDate:this.creatingPoll.startDate};null!==this.creatingPoll.endDate&&(t.poll_endDate=this.creatingPoll.endDate,n.create_endDate=this.creatingPoll.endDate);var r=["poll_startDate","poll_question","poll_description","poll_visible","poll_multiple","poll_answers"].filter((function(e){return!Object.keys(t).includes(e)}));if(!(r.length>0))return n.create_recipe=JSON.stringify(t),ce.makeReq("post","create",n).catch((function(t){return e.$toast.error(t)})).then((function(t){e.$toast.success(t.resp_create_msg);var n={question:e.creatingPoll.question,startDate:e.creatingPoll.startDate,link:"/polls/"+le+"?secret="+t.resp_create_pollid.toString(),secret:t.resp_create_pollsecret};null!==e.creatingPoll.endDate&&(n.endDate=e.creatingPoll.endDate),e.user.created.push(n)}));this.$toast.error("Missing key from poll: "+JSON.stringigify(r))},closePoll:function(){var e=this,t={close_hash:this.user.hash,close_token:this.user.token,close_pollid:le};return ce.makeReq("post","close",t).catch((function(t){return e.$toast.error(t)})).then((function(t){return e.$toast.success(t.resp_close_msg)}))},takePoll:function(){var e=this,t={take_fingerprint:this.user.fingerprint,take_hash:this.user.hash,take_token:this.user.token,take_results:this.displayed.answers.map((function(t){return e.displayed.poll_results.find((function(e){return e.text===t})).value})),take_pollid:le};return ce.makeReq("post","take",t).catch((function(t){return e.$toast.error(t)})).then((function(t){return e.$toast.success(t.resp_take_msg)}))},restoreHistory:function(){var e=this,t={myhistory_hash:this.user.hash,myhistory_token:this.user.token};return this.user.created=[],this.user.taken=[],ce.makeReq("post","myhistory",t).catch((function(t){return e.$toast.error(t)})).then((function(t){if(null!==t.resp_myhistory){e.$toast.success(t.resp_myhistory_msg);for(var n=t.resp_myhistory_polls,r=t.resp_myhistory_created,o=0,l=Object.entries(n);o<l.length;o++){var s=Object(Y["a"])(l[o],2),i=s[0],a=s[1],c=JSON.parse(a[2][1]),u=new Date(c.poll_startDate),d=a[1][1],p={question:c.poll_question,link:"/polls/"+i+"?secret="+d,startDate:u,secret:d};null!==c.poll_endDate&&(p.endDate=new Date(c.poll_endDate)),r.includes(i)?e.user.created.push(p):e.user.taken.push(p)}}else e.$toast.error(t.resp_myhistory_msg)}))},logout:function(){this.user={token:"",hash:"",email:"",fingerprint:"",created:[],taken:[],token_asked:!1,token_sent:!1},ae.clear()}},watch:{user:{deep:!0,handler:function(e){[this.user.token,this.user.hash,this.user.email,this.user.fingerprint,this.user.created,this.user.taken].every((function(e){return""!==e}))&&ae.set(e)}}}};n("344a");ue.render=H,ue.__scopeId="data-v-49ea2798";var de=ue,pe={name:"App",components:{Requests:de}};n("3503");pe.render=o;var be=pe,fe=n("af56");n("a766");Object(r["e"])(be).use(fe["a"],{position:"top-left"}).mount("#app")},"610a":function(e,t,n){e.exports=n.p+"img/bees_thumb.93bd0569.png"},"80b5":function(e,t,n){},a766:function(e,t,n){},b981:function(e,t,n){}});
//# sourceMappingURL=app.0150ba9c.js.map