(function(e){function t(t){for(var r,i,s=t[0],a=t[1],c=t[2],p=0,d=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(l,i)&&l[i]&&d.push(l[i][0]),l[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var a=n[s];0!==l[a]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},l={app:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=a;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},3503:function(e,t,n){"use strict";n("80b5")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function l(e,t,n,l,o,i){var s=Object(r["w"])("requests");return Object(r["o"])(),Object(r["f"])(s)}n("a4d3"),n("e01a");var o=n("610a"),i=n.n(o),s=Object(r["G"])("data-v-919ae3b8");Object(r["r"])("data-v-919ae3b8");var a={class:"container mb-14 p-8"},c=Object(r["i"])("a",{href:"/"},[Object(r["i"])("img",{alt:"bees",src:i.a,style:{opacity:"60%",width:"27%",display:"block","margin-left":"auto","margin-right":"auto"}})],-1),u=Object(r["i"])("p",{class:"mt-8 font-medium font-sans text-2xl"},"Poll'em",-1),p=Object(r["i"])("p",{class:"font-sans mb-8"},[Object(r["h"])(" A simple & hassle-free poll application "),Object(r["i"])("span",{class:"font-thin"}," with a Haskell backend.")],-1),d=Object(r["i"])("div",null,[Object(r["i"])("p",{class:"font-bold"},"Done"),Object(r["i"])("ul",null,[Object(r["i"])("li",null,"Private polls by default"),Object(r["i"])("li",null,"Authentication via email"),Object(r["i"])("li",null,'Uniqueness checks (no "double voting")'),Object(r["i"])("li",null,"Shareable with authorized links")]),Object(r["i"])("p",{class:"font-bold"},"To do"),Object(r["i"])("ul",null,[Object(r["i"])("li",null,"Closable polls"),Object(r["i"])("li",null,"Email notification on poll close"),Object(r["i"])("li",null,"Push notification on poll close"),Object(r["i"])("li",null,"Public API")])],-1),b={key:0,class:"m-4"},h={key:1,class:"m-4"},f=Object(r["i"])("p",null," You do not appear to be authenticated on this app. This means you can only view already existing polls. How about you authenticate so that you can start creating polls? ",-1),g={class:"m-8"},y={key:1,class:"disabled:opacity-50 ml-2 p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md",disabled:""},m={key:0,class:"mt-4"},O={key:1,class:"disabled:opacity-50 p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75",disabled:""},j={key:0,class:"mt-10"},_={id:"displayed",class:"flex flex-col"},k=Object(r["i"])("label",{for:"takingMultiple"},"Allowed to select multiple answers?",-1),v=Object(r["i"])("label",{for:"takingVisible"},"Results visible during poll?",-1),w={class:"space-x-3"},x=Object(r["i"])("label",{for:"takingStartDate"},"Poll started at:",-1),P={key:0},D=Object(r["i"])("label",{class:"space-y-3",for:"takingEndDate"},"(optional) Poll due to close at:",-1),S={key:1},q=Object(r["i"])("p",null,"Nothing to render.",-1),A={id:"creatingPoll",class:"flex flex-col"},C={class:"mt-5"},T=Object(r["i"])("label",{for:"creatingMultiple"},"Allow to select multiple answers",-1),$=Object(r["i"])("label",{for:"creatingVisible"},"Make results visible during poll",-1),R={class:"mt-3 space-y-2"},V=Object(r["i"])("label",{for:"creatingStartDate"},"Poll should start at:",-1),I=Object(r["i"])("br",null,null,-1),E=Object(r["i"])("label",{for:"creatingEndDate"},"(optional) Poll should end at:",-1),M={key:0},U=Object(r["i"])("label",null,"created",-1),N=Object(r["i"])("label",null,"taken:",-1),B={class:"mt-5"},J=Object(r["i"])("p",{class:"text-sm font-light"}," You've taken or created polls you think should be displayed here? You can retrieve your entire history. Please be considerate in your use of this feature, as the database is not optimized for this (expect serious debounce). Also your last created poll might be missing if you created it very recently. ",-1),H={class:"text-right mr-80"},F=Object(r["i"])("p",{class:"mt-14"},"Your daily bees fact:",-1),L={class:"font-extralight italic"};Object(r["p"])();var Y=s((function(e,t,n,l,o,i){var Y=Object(r["w"])("tab"),z=Object(r["w"])("vue-echarts"),Q=Object(r["w"])("datepicker"),G=Object(r["w"])("tabs");return Object(r["o"])(),Object(r["f"])("div",a,[c,u,p,Object(r["i"])("div",null,[Object(r["i"])(G,{modelValue:l.active,"onUpdate:modelValue":t[17]||(t[17]=function(e){return l.active=e})},{default:s((function(){return[Object(r["i"])(Y,{title:"Changelog and features"},{default:s((function(){return[d]})),_:1}),Object(r["i"])(Y,{title:"Your account"},{default:s((function(){return[i.loggedIn?(Object(r["o"])(),Object(r["f"])("div",b,[Object(r["i"])("p",null,"Welcome, "+Object(r["y"])(o.user.email),1),Object(r["i"])("button",{onClick:t[1]||(t[1]=function(){return i.logout&&i.logout.apply(i,arguments)}),class:"mt-2 p-1 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Logout ")])):(Object(r["o"])(),Object(r["f"])("div",h,[f,Object(r["i"])("div",g,[Object(r["i"])("div",null,[Object(r["E"])(Object(r["i"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.user.email=e}),type:"text",placeholder:"email address",disabled:o.user.token_asked},null,8,["disabled"]),[[r["A"],o.user.email]]),o.user.token_asked?(Object(r["o"])(),Object(r["f"])("button",y," Authenticate ")):(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[3]||(t[3]=function(){return i.askToken&&i.askToken.apply(i,arguments)}),class:"ml-2 p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Authenticate "))]),o.user.token_asked?(Object(r["o"])(),Object(r["f"])("div",m,[Object(r["E"])(Object(r["i"])("input",{"onUpdate:modelValue":t[4]||(t[4]=function(e){return o.user.token=e}),type:"text",placeholder:"paste the token here"},null,512),[[r["A"],o.user.token]]),o.user.token.length>3&&!o.user.token_sent?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[5]||(t[5]=function(){return i.confirmToken&&i.confirmToken.apply(i,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Confirm token ")):Object(r["g"])("",!0),o.user.token_sent?(Object(r["o"])(),Object(r["f"])("button",O," Confirm token ")):Object(r["g"])("",!0)])):Object(r["g"])("",!0)])]))]})),_:1}),Object(r["i"])(Y,{title:"Take the poll"},{default:s((function(){return[o.displayed.poll_startDate?(Object(r["o"])(),Object(r["f"])("div",j,[Object(r["i"])("div",_,[Object(r["i"])("div",null,[Object(r["i"])("textarea",{id:"takingQuestion",rows:"2",cols:"30",value:o.displayed.poll_question,disabled:""},null,8,["value"])]),o.chart.scores.length>0&&o.displayed.poll_visible?(Object(r["o"])(),Object(r["f"])(z,{key:0,option:o.chart.options,style:i.chartStyle,ref:"chart"},null,8,["option","style"])):Object(r["g"])("",!0),Object(r["i"])("div",null,[Object(r["i"])("textarea",{id:"takingDescription",rows:"3",cols:"45",value:o.displayed.poll_description,disabled:""},null,8,["value"])]),(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(o.displayed.poll_results,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{key:t},[Object(r["i"])("div",null,[Object(r["i"])("label",null,Object(r["y"])(e.text),1),Object(r["i"])("input",{class:"ml-4",type:"checkbox",onChange:function(e){return i.toggleResults(t)},checked:e.value},null,40,["onChange","checked"])])])})),128)),Object(r["i"])("div",null,[k,Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"takingMultiple",checked:o.displayed.poll_multiple,disabled:""},null,8,["checked"]),v,Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"takingVisible",checked:o.displayed.poll_visible,disabled:""},null,8,["checked"])]),Object(r["i"])("div",w,[x,Object(r["i"])("input",{type:"text",id:"takingStartDate",value:o.displayed.poll_startDate,disabled:""},null,8,["value"]),o.displayed.poll_endDate?(Object(r["o"])(),Object(r["f"])("div",P,[D,Object(r["i"])("input",{type:"text",id:"takingEndDate",value:o.displayed.poll_endDate,disabled:""},null,8,["value"])])):Object(r["g"])("",!0)])]),Object(r["i"])("button",{onClick:t[6]||(t[6]=function(){return i.takePoll&&i.takePoll.apply(i,arguments)}),class:"my-5 w-1/3 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Take the poll ")])):(Object(r["o"])(),Object(r["f"])("div",S,[q]))]})),_:1}),Object(r["i"])(Y,{title:"Create a poll"},{default:s((function(){return[Object(r["i"])("div",A,[Object(r["i"])("div",null,[Object(r["E"])(Object(r["i"])("textarea",{id:"creatingQuestion",rows:"2",cols:"30","onUpdate:modelValue":t[7]||(t[7]=function(e){return o.creatingPoll.question=e})},null,512),[[r["A"],o.creatingPoll.question]])]),Object(r["i"])("div",null,[Object(r["E"])(Object(r["i"])("textarea",{id:"creatingDescription",rows:"3",cols:"45","onUpdate:modelValue":t[8]||(t[8]=function(e){return o.creatingPoll.description=e})},null,512),[[r["A"],o.creatingPoll.description]])]),Object(r["i"])("div",null,[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(o.creatingPoll.answers,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{class:"my-4",key:"answer"+t},[Object(r["i"])("label",{class:"mr-4",for:"creatingAnswer"+t},"Answer #"+Object(r["y"])(t+1),9,["for"]),Object(r["i"])("input",{type:"text",onInput:function(e){return o.creatingPoll.answers[t]=e.target.value}},null,40,["onInput"])])})),128))]),Object(r["i"])("div",null,[Object(r["i"])("button",{onClick:t[9]||(t[9]=function(){return i.addAnswer&&i.addAnswer.apply(i,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," more answers... "),o.creatingPoll.answers.length>2?(Object(r["o"])(),Object(r["f"])("button",{key:0,onClick:t[10]||(t[10]=function(){return i.removeAnswer&&i.removeAnswer.apply(i,arguments)}),class:"ml-2 p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," less ")):Object(r["g"])("",!0)]),Object(r["i"])("div",C,[T,Object(r["E"])(Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"creatingMultiple","onUpdate:modelValue":t[11]||(t[11]=function(e){return o.creatingPoll.multiple=e})},null,512),[[r["z"],o.creatingPoll.multiple]]),$,Object(r["E"])(Object(r["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"creatingVisible","onUpdate:modelValue":t[12]||(t[12]=function(e){return o.creatingPoll.visible=e})},null,512),[[r["z"],o.creatingPoll.visible]])]),Object(r["i"])("div",R,[V,Object(r["i"])(Q,{id:"creatingStartDate",modelValue:o.creatingPoll.startDate,"onUpdate:modelValue":t[13]||(t[13]=function(e){return o.creatingPoll.startDate=e})},null,8,["modelValue"]),I,E,Object(r["i"])(Q,{id:"creatingEndDate",modelValue:o.creatingPoll.endDate,"onUpdate:modelValue":t[14]||(t[14]=function(e){return o.creatingPoll.endDate=e})},null,8,["modelValue"])])]),Object(r["i"])("button",{onClick:t[15]||(t[15]=function(){return i.createPoll&&i.createPoll.apply(i,arguments)}),class:"my-5 w-1/3 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Create the poll ")]})),_:1}),i.loggedIn?(Object(r["o"])(),Object(r["f"])(Y,{key:0,title:"My Polls"},{default:s((function(){return[i.mypolls.length>0?(Object(r["o"])(),Object(r["f"])("div",M,[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(i.mypolls,(function(e,t){return Object(r["o"])(),Object(r["f"])("div",{key:t,class:"grid grid-cols-6 gap-1"},[Object(r["i"])("div",null,[Object(r["i"])("a",{href:"#",onClick:function(t){return i.switchToRestored(e.pollid)}},Object(r["y"])(e.question),9,["onClick"])]),Object(r["i"])("div",null,[Object(r["i"])("button",{class:"p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75",onClick:function(t){return i.clipBoard(e.pollid,e.secret)}}," Share link ",8,["onClick"])]),Object(r["i"])("div",null,[U,Object(r["i"])("input",{class:"ml-3",disabled:"",type:"checkbox",checked:o.user.created.some((function(t){return t.pollid===e.pollid}))},null,8,["checked"])]),Object(r["i"])("div",null,[N,Object(r["i"])("input",{class:"ml-3",disabled:"",type:"checkbox",checked:o.user.taken.some((function(t){return t.pollid===e.pollid}))},null,8,["checked"])]),Object(r["i"])("div",null,Object(r["y"])(e.startDate),1),Object(r["i"])("div",null,Object(r["y"])(null!==e.endDate||"No end date"),1)])})),128))])):Object(r["g"])("",!0),Object(r["i"])("div",B,[J,Object(r["i"])("button",{onClick:t[16]||(t[16]=function(){return i.restoreHistory&&i.restoreHistory.apply(i,arguments)}),class:"mt-4 p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Retrieve entire history ")])]})),_:1})):Object(r["g"])("",!0)]})),_:1},8,["modelValue"]),Object(r["i"])("div",H,[F,Object(r["i"])("p",L,Object(r["y"])(o.todayFact)+".",1)])])])})),z=n("3835"),Q=n("2909"),G=(n("caad"),n("2532"),n("1276"),n("ac1f"),n("4de4"),n("b64b"),n("d3b7"),n("d81d"),n("25f0"),n("99af"),n("13d5"),n("159b"),n("7db0"),n("4fad"),n("24e7")),W=n("6f08"),K=n("a5bb"),X={class:"mx-80 object-center"},Z={class:"flex flex-row"},ee=Object(r["i"])("div",{class:"bg-gray-300 -m-1 h-1"},null,-1),te={class:"mt-6"};function ne(e,t,n,l,o,i){return Object(r["o"])(),Object(r["f"])("div",X,[Object(r["i"])("ul",Z,[(Object(r["o"])(!0),Object(r["f"])(r["a"],null,Object(r["u"])(l.tabs,(function(e,t){return Object(r["o"])(),Object(r["f"])("li",{key:t,class:[l.active===t?"border-b-4 border-yellow-500 text-gray-800":"border-b-2 border-white text-gray-500","flex items-center px-6 py-3 rounded-tl-md rounded-tr-md overflow-hidden cursor-pointer hover:text-gray-800"],onClick:function(e){return l.selectTab(t)}},Object(r["y"])(e.props.title),11,["onClick"])})),128))]),ee,Object(r["i"])("div",te,[Object(r["v"])(e.$slots,"default")])])}n("a9e3");var re={name:"Tabs",props:{modelValue:{type:[String,Number]}},emits:["update:modelValue"],setup:function(e,t){var n=t.emit,l=Object(r["d"])((function(){return e.modelValue})),o=Object(r["s"])([]);function i(e){n("update:modelValue",e)}return Object(r["q"])("tabsState",{active:l,tabs:o}),{tabs:o,active:l,selectTab:i}}};re.render=ne;var le=re,oe={key:0};function ie(e,t,n,l,o,i){return l.isActive?(Object(r["o"])(),Object(r["f"])("div",oe,[Object(r["v"])(e.$slots,"default")])):Object(r["g"])("",!0)}n("c740");var se={name:"Tab",props:{title:String},setup:function(){var e=Object(r["k"])(),t=Object(r["m"])("tabsState"),n=t.tabs,l=t.active,o=Object(r["d"])((function(){return n.value.findIndex((function(t){return t.uid===e.uid}))})),i=Object(r["d"])((function(){return o.value===l.value}));return Object(r["C"])((function(){-1===o.value&&n.value.push(e)})),{isActive:i}}};se.render=ie;var ae=se,ce=null,ue=null,pe="prod",de={noLocalStorage:"`localStorage API` not supported, this application will not work properly.",noCookieSet:"Sorry but you appear to have cleared your cookies",loaded:"App loaded successfully.",endpoint:"The endpoint ran into an error: "},be={status:!0,check:function(){return localStorage||(this.status=!1),this.status},set:function(e){localStorage.setItem("pollem-user",JSON.stringify(e))},get:function(){return JSON.parse(localStorage.getItem("pollem-user"))},clear:function(){localStorage.removeItem("pollem-user")}},he={server_url:{dev:"http://localhost:8009",prod:"https://pollem-now.herokuapp.com"},checkURI:function(e){if(!e.includes("polls"))return{pollid:null,secret:null};var t=e.split("#")[1].split("/")[2];return t.includes("?")?{pollid:t.split("?")[0],secret:t.split("=")[1]}:{pollid:t.split("?")[0],secret:null}},valid_keys:{post:{ask_token:{req:["ask_email"],resp:["resp_ask_token"]},close:{req:["close_hash","close_token","close_pollid"],resp:["resp_close_msg"]},confirm_token:{req:["confirm_token","confirm_fingerprint","confirm_email"],resp:["resp_confirm_msg","resp_confirm_token","resp_confirm_hash"]},create:{req:["create_hash","create_token","create_recipe","create_startDate","create_recipe"],resp:["resp_create_msg","resp_create_pollid","resp_create_pollsecret"]},myhistory:{req:["myhistory_hash","myhistory_token"],resp:["resp_myhistory_polls","resp_myhistory_taken","resp_myhistory_created","resp_myhistory_msg"]},take:{req:["take_fingerprint","take_hash","take_token","take_results"],resp:["resp_take_msg"]}},get:{polls:{resp:["resp_get_poll_msg","resp_get_poll","resp_get_poll_scores"]},warmup:{resp:["resp_warmup_msg"]}}},tryPayload:function(e,t){var n=t.filter((function(t){return!Object.keys(e).includes(t)}));if(n.length>0)throw new Error("Missing key(s) from payload: "+JSON.stringify(n))},tryRoute:function(e,t){if(!Object.keys(this.valid_keys[e]).includes(t))throw new Error("Invalid route: "+e+" and route "+t)},makeReq:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.tryRoute(e,t);var l=this.server_url[pe],o=l+"/"+t;if("polls"===t&&(o=o+"/"+ce+"?secret="+ue),"get"===e)return fetch(o).then((function(e){return e.json()})).then((function(r){return n.tryPayload(r,n.valid_keys[e][t].resp),r}));if(null===r)throw new Error("Empty payload found in "+o+"request.");this.tryPayload(r,this.valid_keys[e][t].req);var i={headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(r)};return fetch(o,i).then((function(e){return e.json()})).then((function(r){return n.tryPayload(r,n.valid_keys[e][t].resp),r}))}},fe={name:"requests",components:{Tabs:le,Tab:ae,VueEcharts:W["a"],Datepicker:G["a"]},data:function(){return{Host:"https://hardcore-hopper-66afd6.netlify.app",creatingPoll:{startDate:null,endDate:null,question:"question...",description:"description...",multiple:!1,visible:!1,private:!1,answers:["Answer#1","Answer#2"]},displayed:{},chart:{scores:[],options:{}},user:{token:"",hash:"",email:"",fingerprint:"",created:[],taken:[],token_asked:!1,token_sent:!1},bees_facts:["Bees have 5 eyes","Bees are insects, so they have 6 legs","Male bees in the hive are called drones","Bees fly about 20 mph","Female bees in the hive (except the queen) are called worker bees","Number of eggs laid by queen: 2,000 per day is the high","Losing its stinger will cause a bee to die","Bees have been here about 30 million years!","Bees carry pollen on their hind legs in a pollen basket or corbicula","An average beehive can hold around 50,000 bees","Foragers must collect nectar from about 2 million flowers to make 1 pound of honey","The average forager makes about 1/12 th of a teaspoon of honey in her lifetime","Average per capita honey consumption in the US is 1.3 pounds","Bees have 2 pairs of wings","The principal form of communication among honey bees is through chemicals called pheromones","Bees are important because they pollinate approximately 130 agricultural crops in the US including fruit, fiber, nut, and vegetable crops. Bee pollination adds approximately 14 billion dollars annually to improved crop yield and quality."],todayFact:""}},setup:function(){var e,t=he.checkURI(window.location.href),n=t.pollid,l=t.secret;return null!==n?(ce=parseInt(n),ue=l,e=Object(r["s"])(2)):e=Object(r["s"])(1),{active:e}},mounted:function(){var e=this;K["a"].load().then((function(e){return e.get()})).then((function(t){be.check()?(e.user=null===be.get()?e.user:be.get(),e.user.fingerprint=t.visitorId):e.$toast.error(de.noLocalStorage);var n=Math.floor(Math.random()*e.bees_facts.length);if(e.todayFact=e.bees_facts[n],e.creatingPoll.startDate=new Date,null!==ce)return he.makeReq("get","polls").catch((function(t){return e.$toast.error(t)})).then((function(t){he.tryPayload(t,he.valid_keys.get.polls.resp);var n=t.resp_get_poll;e.displayed=Object.assign(e.displayed,n),n.poll_endDate||(e.displayed.poll_endDate=null),e.displayed.answers&&(e.displayed.answers=n.poll_answers.map((function(e){return{text:e,value:!1}}))),t.resp_get_poll_scores&&(e.chart.scores=t.resp_get_poll_scores.map((function(e){return parseInt(e)})),e.setChartOptions(e.displayed.poll_answers,e.chart.scores)),e.$toast.success(de.loaded+" Here is your poll. ("+t.resp_get_poll_msg+")")}));he.makeReq("get","warmup").catch((function(t){return e.$toast.error(t)})).then((function(t){return e.$toast.info(t.resp_warmup_msg)}))}))},computed:{loggedIn:function(){return[this.user.token,this.user.hash,this.user.email,this.user.fingerprint].every((function(e){return""!==e}))},chartStyle:function(){var e=this.displayed.poll_answers.length;return 0===e?null:"width: 900px; height: "+(75*e).toString()+"px"},mypolls:function(){var e=[].concat(Object(Q["a"])(this.user.created),Object(Q["a"])(this.user.taken));return e.reduce((function(e,t){if(e[0].includes(t.pollid))return e;var n=[].concat(Object(Q["a"])(e[0]),[t.pollid]),r=[].concat(Object(Q["a"])(e[1]),[t]);return[n,r]}),[[],[]]).pop()}},methods:{switchToRestored:function(e){var t=this;return fetch(he.server_url[pe]+"/polls/"+e).then((function(e){return e.json()})).then((function(n){he.tryPayload(n,he.valid_keys.get.polls.resp);var r=n.resp_get_poll;t.displayed=Object.assign(t.displayed,r),r.poll_endDate||(t.displayed.poll_endDate=null),t.displayed.poll_answers&&(t.displayed.poll_results=r.poll_answers.map((function(e){return{text:e,value:!1}}))),null!==n.resp_get_poll_scores&&(t.chart.scores=n.resp_get_poll_scores.map((function(e){return parseInt(e)})),t.setChartOptions(t.displayed.poll_answers,t.chart.scores)),ce=e,t.active=1}))},setChartOptions:function(e,t){this.chart.options={yAxis:{type:"category",data:e},xAxis:{type:"value"},series:[{data:t,type:"bar"}]}},clipBoard:function(e,t){var n=this,r=this.Host+"/#/polls/"+e+"?secret="+t;navigator.clipboard.writeText(r).then((function(){return n.$toast.info("Copied to clipboard.")})).catch((function(){return n.$toast.warning("Unable to copy, please open the link and copy from your URL bar")}))},toggleResults:function(e){this.displayed.poll_results[e].value=!this.displayed.poll_results[e].value,this.displayed.poll_multiple||this.displayed.poll_results.forEach((function(t,n){return t.value=n===e&&t.value}))},addAnswer:function(){var e=this.creatingPoll.answers.length+1;this.creatingPoll.answers.push("Answer#"+e.toString())},removeAnswer:function(){this.creatingPoll.answers.pop()},makeReq:function(e,t,n){var r=this,l=he.server_url[pe],o=he.tryRoute(e,t);if(null!==o){var i=l+o;if(he.routes.get.some((function(e){return e===o})))return fetch(i).catch((function(e){return r.$toast.error(e)})).then((function(e){return e.json()}));var s=he.post[t].filter((function(e){return!Object.keys(n).includes(e)}));if(!(s.length>0)){var a={headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",body:JSON.stringify(n)};return fetch(i,a).catch((function(e){return r.$toast.error(e)})).then((function(e){return e.json()}))}this.$toast.error("Missing key(s) from payload: "+JSON.stringify(s))}else this.$toast.error("Bad endpoint! Request aborted.")},askToken:function(){var e=this;this.user.token_asked=!0;var t={ask_email:this.user.email};return he.makeReq("post","ask_token",t).catch((function(t){return e.$toast.error(t)})).then((function(t){e.$toast.success(t.resp_ask_token,{duration:1e4})}))},confirmToken:function(){var e=this;this.user.token_sent=!0;var t={confirm_token:this.user.token,confirm_fingerprint:this.user.fingerprint,confirm_email:this.user.email};return he.makeReq("post","confirm_token",t).catch((function(t){return e.$toast.error(t)})).then((function(t){t.resp_confirm_token&&t.resp_confirm_hash?(e.user.token=t.resp_confirm_token,e.user.hash=t.resp_confirm_hash,e.$toast.success(t.resp_confirm_msg)):e.$toast.warning(t.resp_confirm_msg)}))},createPoll:function(){var e=this,t={poll_startDate:this.creatingPoll.startDate,poll_question:this.creatingPoll.question,poll_description:this.creatingPoll.description,poll_multiple:this.creatingPoll.multiple,poll_visible:this.creatingPoll.visible,poll_answers:this.creatingPoll.answers},n={create_hash:this.user.hash,create_token:this.user.token,create_startDate:this.creatingPoll.startDate};null!==this.creatingPoll.endDate&&(t.poll_endDate=this.creatingPoll.endDate,n.create_endDate=this.creatingPoll.endDate);var r=["poll_startDate","poll_question","poll_description","poll_visible","poll_multiple","poll_answers"].filter((function(e){return!Object.keys(t).includes(e)}));if(!(r.length>0))return n.create_recipe=JSON.stringify(t),he.makeReq("post","create",n).catch((function(t){return e.$toast.error(t)})).then((function(t){e.$toast.success(t.resp_create_msg);var n={question:e.creatingPoll.question,startDate:e.creatingPoll.startDate,secret:t.resp_create_pollsecret,pollid:t.resp_create_pollid};null!==e.creatingPoll.endDate&&(n.endDate=e.creatingPoll.endDate),e.user.created.push(n)}));this.$toast.error("Missing key from poll: "+JSON.stringigify(r))},closePoll:function(){var e=this,t={close_hash:this.user.hash,close_token:this.user.token,close_pollid:ce.toString()};return he.makeReq("post","close",t).catch((function(t){return e.$toast.error(t)})).then((function(t){return e.$toast.success(t.resp_close_msg)}))},takePoll:function(){var e=this,t={take_fingerprint:this.user.fingerprint,take_hash:this.user.hash,take_token:this.user.token,take_results:this.displayed.poll_answers.map((function(t){return e.displayed.poll_results.find((function(e){return e.text===t})).value?1:0})),take_pollid:ce.toString()};return he.makeReq("post","take",t).catch((function(t){return e.$toast.error(t)})).then((function(t){return e.$toast.success(t.resp_take_msg)}))},restoreHistory:function(){var e=this,t={myhistory_hash:this.user.hash,myhistory_token:this.user.token};return this.user.created=[],this.user.taken=[],he.makeReq("post","myhistory",t).catch((function(t){return e.$toast.error(t)})).then((function(t){if(null!==t.resp_myhistory){e.$toast.success(t.resp_myhistory_msg);for(var n=t.resp_myhistory_polls,r=t.resp_myhistory_created,l=t.resp_myhistory_taken,o=0,i=Object.entries(n);o<i.length;o++){var s=Object(z["a"])(i[o],2),a=s[0],c=s[1],u=JSON.parse(c[2][1]),p=new Date(u.poll_startDate),d=c[1][1],b={question:u.poll_question,startDate:p,secret:d,pollid:a};null!==u.poll_endDate&&(b.endDate=new Date(u.poll_endDate)),r.includes(a)&&e.user.created.push(b),l.includes(a)&&e.user.taken.push(b)}}else e.$toast.error(t.resp_myhistory_msg)}))},logout:function(){this.user={token:"",hash:"",email:"",fingerprint:"",created:[],taken:[],token_asked:!1,token_sent:!1},be.clear()}},watch:{user:{deep:!0,handler:function(e){[this.user.token,this.user.hash,this.user.email,this.user.fingerprint,this.user.created,this.user.taken].every((function(e){return""!==e}))&&be.set(e)}}}};n("91b9");fe.render=Y,fe.__scopeId="data-v-919ae3b8";var ge=fe,ye={name:"App",components:{Requests:ge}};n("3503");ye.render=l;var me=ye,Oe=n("af56");n("a766");Object(r["e"])(me).use(Oe["a"],{position:"top-left"}).mount("#app")},"610a":function(e,t,n){e.exports=n.p+"img/bees_thumb.93bd0569.png"},"80b5":function(e,t,n){},"83c5":function(e,t,n){},"91b9":function(e,t,n){"use strict";n("83c5")},a766:function(e,t,n){}});
//# sourceMappingURL=app.e5debffb.js.map