(function(e){function t(t){for(var o,l,i=t[0],s=t[1],c=t[2],d=0,b=[];d<i.length;d++)l=i[d],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&b.push(r[l][0]),r[l]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);u&&u(t);while(b.length)b.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,i=1;i<n.length;i++){var s=n[i];0!==r[s]&&(o=!1)}o&&(a.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},r={app:0},a=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},3503:function(e,t,n){"use strict";n("80b5")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23");function r(e,t,n,r,a,l){var i=Object(o["w"])("requests");return Object(o["o"])(),Object(o["f"])(i)}n("a4d3"),n("e01a");var a=n("610a"),l=n.n(a),i=Object(o["G"])("data-v-fee6b404");Object(o["r"])("data-v-fee6b404");var s={class:"container mb-14 p-8"},c=Object(o["i"])("img",{alt:"bees",src:l.a,style:{opacity:"60%",width:"35%",display:"block","margin-left":"auto","margin-right":"auto"}},null,-1),u=Object(o["i"])("p",{class:"mt-8 font-medium font-sans text-2xl"},"Poll'em",-1),d=Object(o["i"])("p",{class:"font-sans mb-8"}," A simple, hassle-free and performant polling application written in Haskell. ",-1),b={key:0,class:"m-4"},p=Object(o["i"])("p",null," You do not appear to be authenticated on this app. This means you can only view already existing polls. How about you authenticate so that you can start creating polls? ",-1),f={class:"m-8"},g={key:1,class:"disabled:opacity-50 p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md",disabled:""},h={key:0,class:"mt-4"},O={key:1,class:"disabled:opacity-50 p-1 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75",disabled:""},m={key:1},k={key:0},j={id:"takingPoll",class:"flex flex-col space-y-3"},v=Object(o["i"])("label",{class:"mr-4",for:"question"},"Question",-1),y=Object(o["i"])("label",{class:"mr-4",for:"takingDescription"},"Description",-1),w=Object(o["i"])("label",{for:"takingMultiple"},"Allow to select multiple answers",-1),_=Object(o["i"])("label",{for:"takingVisible"},"Make results visible during poll",-1),P={class:"space-x-3"},x=Object(o["i"])("label",{for:"takingStartDate"},"Poll started at:",-1),S={key:0},A=Object(o["i"])("label",{class:"space-y-3",for:"takingEndDate"},"(optional) Poll due to close at:",-1),D={key:1},q=Object(o["i"])("p",null,"Nothing to render.",-1),C={id:"creatingPoll",class:"flex flex-col space-y-3"},T=Object(o["i"])("label",{class:"mr-4",for:"question"},"Question",-1),V=Object(o["i"])("label",{class:"mr-4",for:"creatingDescription"},"Description",-1),E=Object(o["i"])("label",{for:"creatingMultiple"},"Allow to select multiple answers",-1),$=Object(o["i"])("label",{for:"creatingVisible"},"Make results visible during poll",-1),I=Object(o["i"])("label",{for:"creatingStartDate"},"Poll should start at:",-1),N=Object(o["i"])("label",{class:"space-y-3",for:"creatingEndDate"},"(optional) Poll should end at:",-1);Object(o["p"])();var U=i((function(e,t,n,r,a,l){var U=Object(o["w"])("tab"),J=Object(o["w"])("vue-echarts"),M=Object(o["w"])("datepicker"),R=Object(o["w"])("tabs");return Object(o["o"])(),Object(o["f"])("div",s,[c,u,d,Object(o["i"])("div",null,[Object(o["i"])(R,{modelValue:r.active,"onUpdate:modelValue":t[16]||(t[16]=function(e){return r.active=e})},{default:i((function(){return[Object(o["i"])(U,{title:"Your account"},{default:i((function(){return[e.user.hash?(Object(o["o"])(),Object(o["f"])("div",m,[Object(o["i"])("p",null,"Welcome, "+Object(o["y"])(e.user.email),1),Object(o["i"])("button",{onClick:t[5]||(t[5]=function(){return l.logout&&l.logout.apply(l,arguments)}),class:"p-1 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Logout ")])):(Object(o["o"])(),Object(o["f"])("div",b,[p,Object(o["i"])("div",f,[Object(o["i"])("div",null,[Object(o["E"])(Object(o["i"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.user.email=t}),type:"text",placeholder:"email address"},null,512),[[o["A"],e.user.email]]),e.user.token_asked?(Object(o["o"])(),Object(o["f"])("button",g," Authenticate ")):(Object(o["o"])(),Object(o["f"])("button",{key:0,onClick:t[2]||(t[2]=function(){return l.askToken&&l.askToken.apply(l,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Authenticate "))]),e.user.token_asked?(Object(o["o"])(),Object(o["f"])("div",h,[Object(o["E"])(Object(o["i"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.user.token=t}),type:"text",placeholder:"paste the token here"},null,512),[[o["A"],e.user.token]]),e.user.token.length>3&&!e.user.token_sent?(Object(o["o"])(),Object(o["f"])("button",{key:0,onClick:t[4]||(t[4]=function(){return l.confirmToken&&l.confirmToken.apply(l,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Confirm token ")):Object(o["g"])("",!0),e.user.token_sent?(Object(o["o"])(),Object(o["f"])("button",O," Confirm token ")):Object(o["g"])("",!0)])):Object(o["g"])("",!0)])]))]})),_:1}),Object(o["i"])(U,{title:"Poll on display"},{default:i((function(){return[Object(o["i"])("button",{onClick:t[6]||(t[6]=function(){return l.testChart&&l.testChart.apply(l,arguments)})},"Test chart"),e.takingPoll.startDate?(Object(o["o"])(),Object(o["f"])("div",k,[Object(o["i"])("div",j,[e.chart.results.length>0?(Object(o["o"])(),Object(o["f"])(J,{key:0,option:e.chart.options,style:{margin:"0 auto",height:"300px",width:"900px"},ref:"chart"},null,8,["option"])):Object(o["g"])("",!0),Object(o["i"])("div",null,[v,Object(o["i"])("textarea",{id:"takingQuestion",rows:"2",cols:"30",value:e.takingPoll.question,disabled:""},null,8,["value"])]),Object(o["i"])("div",null,[y,Object(o["i"])("textarea",{id:"takingDescription",rows:"3",cols:"45",value:e.takingPoll.description,disabled:""},null,8,["value"])]),Object(o["i"])("div",null,[w,Object(o["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"takingMultiple",checked:e.takingPoll.multiple,disabled:""},null,8,["checked"]),_,Object(o["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"takingVisible",checked:e.takingPoll.visible,disabled:""},null,8,["checked"])]),Object(o["i"])("div",P,[x,Object(o["i"])("input",{type:"text",id:"takingStartDate",value:e.takingPoll.startDate,disabled:""},null,8,["value"]),e.takingPoll.endDate?(Object(o["o"])(),Object(o["f"])("div",S,[A,Object(o["i"])("input",{type:"text",id:"takingEndDate",value:e.takingPoll.endDate,disabled:""},null,8,["value"])])):Object(o["g"])("",!0)]),Object(o["i"])("button",{onClick:t[7]||(t[7]=function(){return l.takePoll&&l.takePoll.apply(l,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Take the poll ")])])):(Object(o["o"])(),Object(o["f"])("div",D,[q]))]})),_:1}),Object(o["i"])(U,{title:"Create a poll"},{default:i((function(){return[Object(o["i"])("div",C,[Object(o["i"])("div",null,[T,Object(o["E"])(Object(o["i"])("textarea",{id:"creatingQuestion",rows:"2",cols:"30","onUpdate:modelValue":t[8]||(t[8]=function(t){return e.creatingPoll.question=t})},null,512),[[o["A"],e.creatingPoll.question]])]),Object(o["i"])("div",null,[V,Object(o["E"])(Object(o["i"])("textarea",{id:"creatingDescription",rows:"3",cols:"45","onUpdate:modelValue":t[9]||(t[9]=function(t){return e.creatingPoll.description=t})},null,512),[[o["A"],e.creatingPoll.description]])]),Object(o["i"])("div",null,[(Object(o["o"])(!0),Object(o["f"])(o["a"],null,Object(o["u"])(e.creatingPoll.answers,(function(t,n){return Object(o["o"])(),Object(o["f"])("div",{class:"my-4",key:"answer"+n},[Object(o["i"])("label",{class:"mr-4",for:"creatingAnswer"+n},"Answer #"+Object(o["y"])(n+1),9,["for"]),Object(o["i"])("input",{type:"text",onInput:function(t){return e.creatingPoll.answers[n]=t.target.value}},null,40,["onInput"])])})),128)),Object(o["i"])("button",{onClick:t[10]||(t[10]=function(){return l.addAnswer&&l.addAnswer.apply(l,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Add answer... ")]),Object(o["i"])("div",null,[E,Object(o["E"])(Object(o["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"creatingMultiple","onUpdate:modelValue":t[11]||(t[11]=function(t){return e.creatingPoll.multiple=t})},null,512),[[o["z"],e.creatingPoll.multiple]]),$,Object(o["E"])(Object(o["i"])("input",{class:"mx-3 mr-5",type:"checkbox",id:"creatingVisible","onUpdate:modelValue":t[12]||(t[12]=function(t){return e.creatingPoll.visible=t})},null,512),[[o["z"],e.creatingPoll.visible]])]),Object(o["i"])("div",null,[I,Object(o["i"])(M,{id:"creatingStartDate",modelValue:e.creatingPoll.startDate,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.creatingPoll.startDate=t})},null,8,["modelValue"]),N,Object(o["i"])(M,{id:"creatingEndDate",modelValue:e.creatingPoll.endDate,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.creatingPoll.endDate=t})},null,8,["modelValue"])]),Object(o["i"])("button",{onClick:t[15]||(t[15]=function(){return l.createPoll&&l.createPoll.apply(l,arguments)}),class:"p-1 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:ring-opacity-75"}," Create a poll ")])]})),_:1})]})),_:1},8,["modelValue"])])])})),J=(n("caad"),n("841c"),n("ac1f"),n("2b3d"),n("d3b7"),n("3ca3"),n("ddb0"),n("25f0"),n("d81d"),n("24e7")),M=n("6f08"),R=n("a5bb"),L={class:"mx-80 object-center"},H={class:"flex flex-row"},Q=Object(o["i"])("div",{class:"bg-gray-300 -m-1 h-1"},null,-1),z={class:"mt-6"};function Y(e,t,n,r,a,l){return Object(o["o"])(),Object(o["f"])("div",L,[Object(o["i"])("ul",H,[(Object(o["o"])(!0),Object(o["f"])(o["a"],null,Object(o["u"])(r.tabs,(function(e,t){return Object(o["o"])(),Object(o["f"])("li",{key:t,class:[r.active===t?"border-b-4 border-yellow-500 text-gray-800":"border-b-2 border-white text-gray-500","flex items-center px-6 py-3 rounded-tl-md rounded-tr-md overflow-hidden cursor-pointer hover:text-gray-800"],onClick:function(e){return r.selectTab(t)}},Object(o["y"])(e.props.title),11,["onClick"])})),128))]),Q,Object(o["i"])("div",z,[Object(o["v"])(e.$slots,"default")])])}n("a9e3");var G={name:"Tabs",props:{modelValue:{type:[String,Number]}},emits:["update:modelValue"],setup:function(e,t){var n=t.emit,r=Object(o["d"])((function(){return e.modelValue})),a=Object(o["s"])([]);function l(e){n("update:modelValue",e)}return Object(o["q"])("tabsState",{active:r,tabs:a}),{tabs:a,active:r,selectTab:l}}};G.render=Y;var W=G,B={key:0};function F(e,t,n,r,a,l){return r.isActive?(Object(o["o"])(),Object(o["f"])("div",B,[Object(o["v"])(e.$slots,"default")])):Object(o["g"])("",!0)}n("c740");var X={name:"Tab",props:{title:String},setup:function(e){var t=Object(o["k"])(),n=Object(o["m"])("tabsState"),r=n.tabs,a=n.active,l=Object(o["d"])((function(){return r.value.findIndex((function(e){return e.uid===t.uid}))})),i=Object(o["d"])((function(){return l.value===a.value}));return console.log(e),Object(o["C"])((function(){-1===l.value&&r.value.push(t)})),{isActive:i}}};X.render=F;var K=X,Z=null,ee={taken:"Sorry but you appear to have taken the survey already.",noLocalStorage:"`localStorage API` not supported, this application will not work properly.",noCookieSet:"Sorry but you appear to have cleared your cookies",loaded:"App loaded successfully.",endpoint:"The endpoint ran into an error: ",tokenAcquired:"Token acquired! Check your email and then paste the result into the approprate field, under 'Your account')"},te={status:!0,check:function(){return localStorage||(this.status=!1),this.status},set:function(e){localStorage.setItem("pollem-user",JSON.stringify(e))},get:function(){return JSON.parse(localStorage.getItem("pollem-user"))},clear:function(){localStorage.removeItem("pollem-user")}},ne={endpoints:["http://localhost:8009","https://pollem-now.herokuapp.com"],tryRoute:function(e){var t=["/ask_token","/confirm_token","/create","/close","/get","/take"];if(t.includes(e))return e;throw new Error("Wrong route: "+e)}},oe={name:"requests",components:{Tabs:W,Tab:K,VueEcharts:M["a"],Datepicker:J["a"]},data:function(){return{localStorage:!0,creatingPoll:{startDate:null,endDate:null,question:"",description:"",multiple:!1,visible:!1,answers:["Answer#1","Answer#2"]},takingPoll:{},chart:{results:[],options:{}},user:{token:"",hash:"",email:"",fingerprint:"",created:[],taken:[],token_asked:!1,token_sent:!1}}},setup:function(){var e=window.location.search.substring(1);Z=new URLSearchParams(e).get("poll_id");var t=null===Z?Object(o["s"])(0):Object(o["s"])(1);return{active:t}},mounted:function(){var e=this;R["a"].load().then((function(e){return e.get()})).then((function(t){if(te.check()?(e.user=null===te.get()?e.user:te.get(),e.user.fingerprint=t.visitorId):e.$toast.error(ee.noLocalStorage),e.creatingPoll.startDate=new Date,null!==Z)return fetch(ne.endpoints[1]+"/"+Z.toString()).catch((function(t){return e.$toast.error(ee.endpoints[1]+t)})).then((function(e){return e.json()})).then((function(t){t.get_poll?(e.takingPoll=JSON.parse(t.get_poll),t.get_poll_results&&(e.chart.results=t.get_poll_results.map((function(e){return parseInt(e)}))),e.$toast.success(ee.loaded+" Here is your poll. ("+t.get_poll_msg+")")):e.$toast.error("Poll received but parsing failed. Unable to carry on.")}));e.$toast.success(ee.loaded)}))},methods:{testChart:function(){var e=this,t={startDate:new Date,endDate:null,question:"How to make an omelette without breaking any egg?",description:"Some description",multiple:!1,visible:!0,answers:["Answer#1","Answer#2"]},n={get_poll_results:[3,5],get_poll:JSON.stringify(t),get_poll_msg:"Ok fine"};return Promise.resolve(JSON.stringify(n)).then((function(t){var n=JSON.parse(t);e.takingPoll=JSON.parse(n.get_poll),n.get_poll_results&&(e.chart.results=n.get_poll_results.map((function(e){return parseInt(e)})),e.setChartOptions()),e.$toast.success(n.get_poll_msg)})).catch((function(t){return e.$toast.error(t)}))},setChartOptions:function(){this.chart.options={yAxis:{type:"category",data:this.takingPoll.answers},xAxis:{type:"value"},series:[{data:this.chart.results,type:"bar",showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)"}}]}},addAnswer:function(){var e=this.creatingPoll.answers.length+1;this.creatingPoll.answers.push("Answer#"+e.toString())},makeReq:function(e,t){var n=this,o=ne.endpoints[1],r=ne.tryRoute(e),a=o+r;if("/get"===e)return fetch(a).catch((function(e){return n.$toast.error(e)})).then((function(e){return e.json()}));var l={method:"POST",headers:{Accept:"application/json","Content-type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET,OPTIONS, PUT, DELETE","Access-Control-Allow-Headers":"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization"},body:JSON.stringify(t)};return fetch(a,l).catch((function(e){return n.$toast.error(e)})).then((function(e){return e.json()}))},askToken:function(){var e=this;this.user.token_asked=!0;var t={ask_email:this.user.email};return this.makeReq("/ask_token",t).then((function(t){e.$toast.success(ee.tokenAcquired+" "+t.ask_token,{duration:6e4,dismissible:!1})}))},confirmToken:function(){var e=this;this.user.token_sent=!0;var t={req_confirm_token:this.user.token,req_confirm_fingerprint:this.user.fingerprint,req_confirm_email:this.user.email};return this.makeReq("/confirm_token",t).then((function(t){t.resp_confirm_token&&t.confirm_hash?(e.user.token=t.confirm_token,e.user.hash=t.confirm_hash,e.$toast.success(t.confirm_msg)):e.$toast.warning(t.confirm_msg)}))},createPoll:function(){var e=this,t={req_create_hash:this.user.hash,req_create_token:this.user.token,req_create_recipe:JSON.stringify(this.creatingPoll),req_create_startDate:this.creatingPoll.startDate};return null!==this.creatingPoll.endDate&&(t.req_create_endDate=this.creatingPoll.endDate),this.makeReq("/create",t).then((function(t){return e.$toast.success(t.create_msg)}))},closePoll:function(){var e=this,t={close_hash:this.user.hash,close_token:this.user.token,close_pollid:Z};return this.makeReq("/close",t).then((function(t){return e.$toast.success(t.close_msg)}))},takePoll:function(){var e=this,t={take_hash:this.user.hashs,take_token:this.user.token,take_fingerprint:this.user.fingerprint,take_pollid:Z,take_answers:this.takingPoll.answers};return this.makeReq("/take",t).then((function(t){return e.$toast.success(t.take_msg)}))},logout:function(){this.user={token:"",hash:"",email:"",fingerprint:"",created:[],taken:[],token_asked:!1,token_sent:!1},te.clear()}},watch:{user:function(e){te.status&&te.set(e)}}};n("fa27");oe.render=U,oe.__scopeId="data-v-fee6b404";var re=oe,ae={name:"App",components:{Requests:re}};n("3503");ae.render=r;var le=ae,ie=n("af56");n("a766");Object(o["e"])(le).use(ie["a"],{position:"bottom"}).mount("#app")},"610a":function(e,t,n){e.exports=n.p+"img/bees_thumb.3f1d3cb7.png"},"80b5":function(e,t,n){},9330:function(e,t,n){},a766:function(e,t,n){},fa27:function(e,t,n){"use strict";n("9330")}});
//# sourceMappingURL=app.a939c064.js.map